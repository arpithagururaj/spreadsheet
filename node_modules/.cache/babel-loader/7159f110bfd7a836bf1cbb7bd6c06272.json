{"ast":null,"code":"var _jsxFileName = \"/home/arpitha/Desktop/8jan/src/App.js\";\nimport React from \"react\";\nimport XLSX from 'xlsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Upload() {\n  const fileUpload = document.getElementById('fileUpload');\n  const regex = /^([a-zA-Z0-9\\s_\\\\.\\-:])+(.xls|.xlsx)$/;\n\n  if (regex.test(fileUpload.value.toLowerCase())) {\n    let fileName = fileUpload.files[0].name;\n\n    if (typeof FileReader !== 'undefined') {\n      const reader = new FileReader();\n\n      if (reader.readAsBinaryString) {\n        reader.onload = e => {\n          processExcel(reader.result);\n        };\n\n        reader.readAsBinaryString(fileUpload.files[0]);\n      }\n    } else {\n      console.log(\"This browser does not support HTML5.\");\n    }\n  } else {\n    console.log(\"Please upload a valid Excel file.\");\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"html\", {\n    lang: \"en\",\n    children: [/*#__PURE__*/_jsxDEV(\"head\", {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Process Excel File\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n        src: \"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.0/xlsx.full.min.js\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"body\", {\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"upload-excel\",\n        type: \"file\",\n        id: \"fileUpload\",\n        onchange: \"Upload()\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 1\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 1\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 27,\n    columnNumber: 1\n  }, this);\n}\n_c = Upload;\n\nfunction processExcel(data) {\n  const workbook = XLSX.read(data, {\n    type: 'binary'\n  });\n  const firstSheet = workbook.SheetNames[0];\n  const excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);\n  console.log(excelRows);\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"Upload\");","map":{"version":3,"sources":["/home/arpitha/Desktop/8jan/src/App.js"],"names":["React","XLSX","Upload","fileUpload","document","getElementById","regex","test","value","toLowerCase","fileName","files","name","FileReader","reader","readAsBinaryString","onload","e","processExcel","result","console","log","data","workbook","read","type","firstSheet","SheetNames","excelRows","utils","sheet_to_row_object_array","Sheets"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,MAAjB;;AAGA,eAAe,SAASC,MAAT,GAAkB;AAE/B,QAAMC,UAAU,GAAIC,QAAQ,CAACC,cAAT,CAAwB,YAAxB,CAApB;AACA,QAAMC,KAAK,GAAG,uCAAd;;AACA,MAAIA,KAAK,CAACC,IAAN,CAAWJ,UAAU,CAACK,KAAX,CAAiBC,WAAjB,EAAX,CAAJ,EAAgD;AAC5C,QAAIC,QAAQ,GAAGP,UAAU,CAACQ,KAAX,CAAiB,CAAjB,EAAoBC,IAAnC;;AACA,QAAI,OAAQC,UAAR,KAAwB,WAA5B,EAAyC;AACrC,YAAMC,MAAM,GAAG,IAAID,UAAJ,EAAf;;AACA,UAAIC,MAAM,CAACC,kBAAX,EAA+B;AAC3BD,QAAAA,MAAM,CAACE,MAAP,GAAiBC,CAAD,IAAO;AACnBC,UAAAA,YAAY,CAACJ,MAAM,CAACK,MAAR,CAAZ;AACH,SAFD;;AAGAL,QAAAA,MAAM,CAACC,kBAAP,CAA0BZ,UAAU,CAACQ,KAAX,CAAiB,CAAjB,CAA1B;AACH;AACJ,KARD,MAQO;AACHS,MAAAA,OAAO,CAACC,GAAR,CAAY,sCAAZ;AACH;AACJ,GAbD,MAaO;AACHD,IAAAA,OAAO,CAACC,GAAR,CAAY,mCAAZ;AACH;;AACD,sBAEF;AAAM,IAAA,IAAI,EAAC,IAAX;AAAA,4BACA;AAAA,8BAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFJ,eAGI;AAAQ,QAAA,GAAG,EAAC;AAAZ;AAAA;AAAA;AAAA;AAAA,cAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,YADA,eAMA;AAAA,6BACA;AAAO,QAAA,KAAK,EAAC,cAAb;AAA4B,QAAA,IAAI,EAAC,MAAjC;AAAwC,QAAA,EAAE,EAAC,YAA3C;AAAwD,QAAA,QAAQ,EAAC;AAAjE;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,YANA;AAAA;AAAA;AAAA;AAAA;AAAA,UAFE;AAaD;KAjCuBnB,M;;AAmCxB,SAASgB,YAAT,CAAsBI,IAAtB,EAA4B;AAC1B,QAAMC,QAAQ,GAAGtB,IAAI,CAACuB,IAAL,CAAUF,IAAV,EAAgB;AAACG,IAAAA,IAAI,EAAE;AAAP,GAAhB,CAAjB;AACA,QAAMC,UAAU,GAAGH,QAAQ,CAACI,UAAT,CAAoB,CAApB,CAAnB;AACA,QAAMC,SAAS,GAAG3B,IAAI,CAAC4B,KAAL,CAAWC,yBAAX,CAAqCP,QAAQ,CAACQ,MAAT,CAAgBL,UAAhB,CAArC,CAAlB;AAEAN,EAAAA,OAAO,CAACC,GAAR,CAAYO,SAAZ;AACD","sourcesContent":["import React from \"react\";\nimport XLSX from 'xlsx';\n\n\nexport default function Upload() {\n  \n  const fileUpload = (document.getElementById('fileUpload'));\n  const regex = /^([a-zA-Z0-9\\s_\\\\.\\-:])+(.xls|.xlsx)$/;\n  if (regex.test(fileUpload.value.toLowerCase())) {\n      let fileName = fileUpload.files[0].name;\n      if (typeof (FileReader) !== 'undefined') {\n          const reader = new FileReader();\n          if (reader.readAsBinaryString) {\n              reader.onload = (e) => {\n                  processExcel(reader.result);\n              };\n              reader.readAsBinaryString(fileUpload.files[0]);\n          }\n      } else {\n          console.log(\"This browser does not support HTML5.\");\n      }\n  } else {\n      console.log(\"Please upload a valid Excel file.\");\n  }\n  return (\n    \n<html lang=\"en\">\n<head>\n   \n    <title>Process Excel File</title>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.0/xlsx.full.min.js\"></script>\n</head>\n<body>\n<input class=\"upload-excel\" type=\"file\" id=\"fileUpload\" onchange=\"Upload()\"/>\n</body>\n</html>\n  )\n}\n\nfunction processExcel(data) {\n  const workbook = XLSX.read(data, {type: 'binary'});\n  const firstSheet = workbook.SheetNames[0];\n  const excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);\n\n  console.log(excelRows);\n}\n\n\n"]},"metadata":{},"sourceType":"module"}